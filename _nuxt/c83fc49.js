(window.webpackJsonp=window.webpackJsonp||[]).push([[9,4],{392:function(e,t,n){var content=n(405);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(32).default)("2cb28f6a",content,!0,{sourceMap:!1})},400:function(e,t,n){var content=n(415);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(32).default)("541cdaf8",content,!0,{sourceMap:!1})},403:function(e,t,n){var content=n(417);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(32).default)("39289280",content,!0,{sourceMap:!1})},404:function(e,t,n){"use strict";n(392)},405:function(e,t,n){var o=n(31)(!1);o.push([e.i,".loading{height:100%}",""]),e.exports=o},406:function(e,t,n){var content=n(419);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(32).default)("7c936ea0",content,!0,{sourceMap:!1})},411:function(e,t,n){"use strict";n.r(t);var o={name:"Loading"},r=(n(404),n(57)),l=n(67),c=n.n(l),d=n(160),component=Object(r.a)(o,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"loading d-flex justify-center align-center"},[t("v-progress-circular",{staticClass:"d-flex justify-center align-center",attrs:{indeterminate:"",color:"accent",size:"50"}})],1)}),[],!1,null,null,null);t.default=component.exports;c()(component,{VProgressCircular:d.a})},414:function(e,t,n){"use strict";n(400)},415:function(e,t,n){var o=n(31)(!1);o.push([e.i,".profile{z-index:100;position:absolute}.profile h3{color:#fff;font-weight:400}",""]),e.exports=o},416:function(e,t,n){"use strict";n(403)},417:function(e,t,n){var o=n(31)(!1);o.push([e.i,".messages{grid-area:messages;overflow-y:auto;height:95%;padding-bottom:25px}.messages .message{display:flex;width:100%;padding:.3% 1%}.messages .message:hover{background-color:#1e1e1e}.messages .message .message-content{margin:0 .3%;display:flex;flex-direction:column;justify-content:center}.messages .message .message-content small{color:grey;font-weight:400}.messages .message .message-content p{color:#d3d3d3;word-break:break-all}.message #message-image{max-width:50%;width:auto;height:100%}",""]),e.exports=o},418:function(e,t,n){"use strict";n(406)},419:function(e,t,n){var o=n(31)(!1);o.push([e.i,".message-field{grid-area:messages;display:flex;position:fixed;width:96%;height:50px;bottom:0}",""]),e.exports=o},423:function(e,t,n){var content=n(434);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(32).default)("5d61e4c4",content,!0,{sourceMap:!1})},429:function(e,t,n){"use strict";n.r(t);var o={name:"Profile",mounted:function(){var e=this;document.body.addEventListener("click",(function(t){t.stopPropagation(),e.$store.commit("profile/hide")}))}},r=(n(414),n(57)),l=n(67),c=n.n(l),d=n(401),f=n(161),m=n(390),v=n(387),h=n(421),_=n(420),component=Object(r.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"show",rawName:"v-show",value:e.$store.state.profile.show,expression:"$store.state.profile.show"}],staticClass:"profile",style:"left: "+e.$store.state.profile.x+"px; top: "+e.$store.state.profile.y+"px",on:{click:function(e){e.stopPropagation()},client:function(e){e.preventDefault(),e.stopPropagation()}}},[n("v-slide-y-transition",[n("v-card",{staticClass:"mx-auto",attrs:{elevation:"3"}},[n("v-card-text",{staticClass:"d-flex justify-end align-center"},[n("h3",{staticClass:"pl-5 pr-2"},[e._v(e._s(e.$store.state.profile.user.name))]),e._v(" "),n("v-avatar",[n("v-img",{attrs:{src:e.$store.state.profile.user.img}})],1)],1),e._v(" "),n("v-card-actions",{staticClass:"d-flex justify-center"},[n("router-link",{attrs:{to:"/chat/"+e.$store.state.profile.user.id}},[n("v-btn",{attrs:{outlined:"",rounded:"",text:"",color:"accent"}},[e._v("\n          enviar mensagem\n        ")])],1)],1)],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports;c()(component,{VAvatar:d.a,VBtn:f.a,VCard:m.a,VCardActions:v.a,VCardText:v.c,VImg:h.a,VSlideYTransition:_.c})},430:function(e,t,n){"use strict";n.r(t);n(56);var o={name:"Messages",props:["messages","loading"],middleware:"auth",data:function(){return{}},methods:{scrollOnMessage:function(){var e=document.querySelector(".messages"),t=new MutationObserver((function(){e.scrollTo(0,e.scrollHeight)}));e.addEventListener("scroll",(function(){e.clientHeight+e.scrollTop>=e.scrollHeight-300?t.observe(e,{childList:!0,subtree:!0}):t.disconnect()}))}},mounted:function(){this.scrollOnMessage()},watch:{loading:function(){setTimeout((function(){return document.querySelector(".messages").scrollTo(0,document.querySelector(".messages").scrollHeight)}),500)}}},r=(n(416),n(57)),l=n(67),c=n.n(l),d=n(401),f=n(421),component=Object(r.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"messages"},[e.loading?n("Loading"):e._e(),e._v(" "),e._l(e.messages,(function(t){return n("div",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],key:t.id,staticClass:"message"},[n("div",{staticClass:"author-img"},[n("v-avatar",[n("v-img",{attrs:{src:t.author.img}})],1)],1),e._v(" "),n("div",{staticClass:"message-content ml-3"},[n("h4",[e._v(e._s(t.author.name)+" "),n("small",[e._v(e._s(e.$dayjs(t.createdAt).fromNow()))])]),e._v(" "),t.img?e._e():n("p",[e._v(e._s(t.content))]),e._v(" "),t.img?n("img",{staticClass:"mt-1 mb-3",attrs:{id:"message-image",src:t.img}}):e._e()])])}))],2)}),[],!1,null,null,null);t.default=component.exports;c()(component,{Loading:n(411).default}),c()(component,{VAvatar:d.a,VImg:f.a})},431:function(e,t,n){"use strict";n.r(t);n(26),n(175);var o={name:"Message_field",data:function(){return{message:"",imageUploadLoading:!1}},methods:{sendMessage:function(){this.$socket.client.emit("message",this.message),this.message=""},logout:function(){localStorage.removeItem("token"),this.$store.commit("user/clear"),this.$socket.client.auth={},this.$socket.client.disconnect(),this.$router.push("/login")},sendImage:function(e){var t=this;if(e.target.files[0]&&-1!=e.target.files[0].type.search("image")){var form=new FormData;form.append("img",e.target.files[0]),this.imageUploadLoading=!0,this.$axios.$post("/message/image",form,{timeout:1e4}).then((function(e){t.imageUploadLoading=!1,t.$socket.client.emit("message",e.src)})).catch((function(){return t.imageUploadLoading=!1}))}}}},r=(n(418),n(57)),l=n(67),c=n.n(l),d=n(401),f=n(424),m=n(161),v=n(131),h=n(461),component=Object(r.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"message-field mb-3 px-4",on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.sendMessage.apply(null,arguments)}}},[n("input",{ref:"inputMessageField",staticStyle:{display:"none"},attrs:{accept:".png, .jpg, .jpeg, .gif, .webp",type:"file",id:"inputMessageField"},on:{change:e.sendImage}}),e._v(" "),n("v-badge",{attrs:{"offset-x":"15",avatar:"","offset-y":"10",dot:"",bottom:"",color:e.$socket.connected?"green":"red"}},[n("v-avatar",{staticClass:"pointer mr-3",attrs:{size:"48"}},[n("img",{attrs:{src:e.$store.state.user.img,alt:e.$store.state.user.name+" pfp",title:e.$store.state.user.name}})])],1),e._v(" "),n("v-text-field",{staticClass:"message-field__input",attrs:{autocomplete:"off",color:"accent",disabled:!e.$socket.connected,label:"Digite...",solo:""},scopedSlots:e._u([{key:"append",fn:function(){return[n("v-btn",{attrs:{color:"accent",loading:e.imageUploadLoading,icon:"",large:""},on:{click:function(t){return e.$refs.inputMessageField.click()}}},[n("v-icon",[e._v("mdi-file-image")])],1),e._v(" "),n("v-btn",{attrs:{color:"accent",icon:"",large:""},on:{click:e.logout}},[n("v-icon",[e._v("mdi-logout")])],1)]},proxy:!0}]),model:{value:e.message,callback:function(t){e.message=t},expression:"message"}})],1)}),[],!1,null,null,null);t.default=component.exports;c()(component,{VAvatar:d.a,VBadge:f.a,VBtn:m.a,VIcon:v.a,VTextField:h.a})},433:function(e,t,n){"use strict";n(423)},434:function(e,t,n){var o=n(31)(!1);o.push([e.i,'.chat{display:grid;height:100vh;grid-template-columns:calc(100% - 75px) 75px;grid-template-areas:"messages online-users"}@media screen and (max-width:960px){.chat{grid-template-columns:100% 0}}',""]),e.exports=o},463:function(e,t,n){"use strict";n.r(t);n(49),n(12);var o={middleware:"auth",data:function(){return{messages:[],loadingMessages:!0}},sockets:{already_connected:function(){this.$store.dispatch("alert/set",{message:"Sua conta est√° conectada em outro lugar",color:"accent",time:1/0,dismissable:!1})},message:function(e){this.verifyContentIsAImage(e),this.messages.push(e)},connect_error:function(e){console.error(e)}},methods:{verifyContentIsAImage:function(e){var t=this;/^(http|https):\/\/[^ "]+$/.test(e.content)&&/\.(png|jpg|jpeg|gif|webp)/g.test(e.content)&&(e.img=e.content,this.$nextTick((function(){t.messages=t.messages.map((function(t){return t._id==e._id?e:t}))})))},getMessages:function(){var e=this;this.$axios("/message").then((function(t){var n=t.data;e.messages=n,e.messages.forEach((function(t){return e.verifyContentIsAImage(t)})),e.loadingMessages=!1}))}},created:function(){this.getMessages()}},r=(n(433),n(57)),component=Object(r.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"chat"},[n("Profile"),e._v(" "),n("Messages",{attrs:{loading:e.loadingMessages,messages:e.messages}}),e._v(" "),n("Online-users"),e._v(" "),n("MessageField")],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Profile:n(429).default,Messages:n(430).default,MessageField:n(431).default})}}]);